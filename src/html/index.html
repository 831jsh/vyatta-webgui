<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
/*
 *  Copyright 2006, Vyatta, Inc.
 *
 *  GNU General Public License
 * 
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License, version 2, 
 *  as published by the Free Software Foundation.
 * 
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 *  02110-1301 USA
 *
 *  Module:           index.html
 *
 *  Original Author:  DHAP Digital, Inc.  Douglas Good & others
 *  Other Author(s):  Marat Nepomnyashy
 *  Date:             2006
 *  Description:      Main index.html file for the GUI
 *
 */
 -->

<html>
<head>
    <title>Vyatta</title>
<style type="text/css">
@import "css/main.css";
</style>
<script type="text/javascript" src="/js/xml.js"></script>
<script type="text/javascript" src="/js/server.js"></script>
<script type="text/javascript" src="/js/ui.js"></script>
<script type="text/javascript" src="/js/app.js"></script>
<script type="text/javascript" src="/js/mods.js"></script>
<script type="text/javascript" src="/js/xgutil.js"></script>
<script type="text/javascript" src="/js/brwsniff.js"></script>
<script type="text/javascript">

function sendServerRequest() {
	var textElement = document.getElementById("xgdRequest1");
	var xml = textElement.value;
	appManager.serverManager.sendRequest(xml);
	showResponse("<i>loading</i>");
}

function sendXmlRequest(xml) {
	var activeX = false;
	var url = "/xgcgi2";

   if (window.XMLHttpRequest) {
	   httpRequest = new XMLHttpRequest();
	}
	else {
	   httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
	   activeX = true;
	}

   httpRequest.onreadystatechange = httpResponseListener;

   showResponse("<i>loading</i>");

   httpRequest.open("POST", url, true);
	httpRequest.setRequestHeader('Content-Type', 'text/xml');
	httpRequest.send(xml);
}

function httpResponseListener() {
	if (httpRequest.readyState == 4) {
	   // "4" indicates a state of "complete"
	   if (httpRequest.status == 200) {
	       // Response is OK
	       handleServerResponse();
	   } else {
	       alert("There was an error during the request : status = " + httpRequest.status + ", text = " + httpRequest.statusText);
	   }
	}
}

function handleServerResponse() {
	showResponse("<xmp>" + httpRequest.responseText + "</xmp>");
}

function showResponse(html) {
	responseDisplay().innerHTML = html;
}

function responseDisplay() {
	return document.getElementById("responseArea");
}

var appManager = null;

function https() {
	var strLocation = "" + window.document.location;
	if (strLocation.substr(0, 7) == "http://") {
		strLocation = "https://" + strLocation.substr(7);
		window.document.location = strLocation;
	}
}

function init() {
	appManager = new AppManager();
	appManager.init();

	document.onclick = useractivity;
	document.onfocus = useractivity;
	document.onkeydown = useractivity;
	document.onkeypress = useractivity;
	document.onkeyup = useractivity;
	document.onmousedown = useractivity;
	document.onmousemove = useractivity;
	document.onmouseup = useractivity;
	document.onscroll = useractivity;

	loginContent();

	var strLocation = "" + window.document.location;
	if (strLocation.substr(0, 7) == "http://") {
		var br = getBrowser();
		if (br != null && br.length >= 4) {
			if (br[0] == "msie" && getMajorVersion(br[1]) == 6) {
				var html = "<p class='warning'><span class='warningLabel'>Warning:</span> ";
				html += "Auto-switching to <a href=\"javascript:https();\">https</a> skipped due to <a href=\"http://support.microsoft.com/kb/305217\" target=\"_new\">Internet Explorer 6 SSL3 session timeout problem</a>.  (Firefox or Internet Explorer 7 recommended.)  Session will not be encrypted in http mode.";
				html += "</p>";
				appManager.uiManager.displayMessageHtml(html);
			} else {
				https();
			}
		}
	}
}

function useractivity(e) {
	if ("appManager" in window && appManager && appManager.state) {
		appManager.state.resetTO();
	}
}
function helpContent() {
	document.getElementById('configArea').innerHTML = "<p><b>This is the Help Content</b></p>"
}

function loadContent() {
	appManager.uiManager.showConfigureContent();
	appManager.state.activeMenu = "load";
	var html = "";

	html += appManager.uiManager.getHtmlBlueHeaderBlock("Load Configuration...");
	html += '<p>';

	html += '<form name="loadArgs" id="loadArgsForm" onsubmit="return false;">';
	html += '<table cellpadding="0" cellspacing="3" border="0">';
	html += '<tr><td>Load filespec:</td></tr> ';
	html += '<tr><td>';
	html += '<input id="loadTextBox" name="loadTextBox" type="text" class="text_field">';
	html += '</td></tr>';
	html += '<tr><td align="right"><a href="javascript:appManager.uiManager.clickLoadFilespec();"><img src="images/bt_load.gif" alt="Load" width="59" height="19" hspace="0" vspace="0" border="0"></a></td></tr>';
	html += '</table>';
	html += '</form>';

	if (appManager.state.changesNotCommitted == true) {
		html += "<p><p>";
		html += appManager.uiManager.getHtmlMods();
	}

	document.getElementById('configArea').innerHTML = html;
	setTimeout('focusById("loadTextBox");', 800);
}

function saveContent() {
	appManager.uiManager.showConfigureContent();
	appManager.state.activeMenu = "save";
	var html = "";

	html += appManager.uiManager.getHtmlBlueHeaderBlock("Save Configuration...");
	html += '<p>';

	if (appManager.getChangesNotCommitted()) {
		html += 'Active-Runtime and Edited configurations differ because edited changes have not been committed.  ';
		html += 'Only the Active-Runtime configuration can be saved.  ';
		html += 'Please commit or revert changes before saving current Active-Runtime configuration...';
		html += "<p>\n";
		html += appManager.uiManager.getHtmlMods();
	} else {
		html += '<form name="saveArgs" id="saveArgsForm" onsubmit="return false;">';
		html += '<table cellpadding="0" cellspacing="3" border="0">';
		html += '<tr><td>Save filespec:</td></tr> ';
		html += '<tr><td>';
		html += '<input id="saveTextBox" name="saveTextBox" type="text" class="text_field">';
		html += '</td></tr>';
		html += '<tr><td align="right"><a href="javascript:appManager.uiManager.clickSaveFilespec();"><img src="images/bt_save.gif" alt="Save" width="59" height="19" hspace="0" vspace="0" border="0"></a></td></tr>';
		html += '</table>';
		html += '</form>';
	}

	document.getElementById('configArea').innerHTML = html;

	if (!appManager.getChangesNotCommitted()) setTimeout('focusById("saveTextBox");', 800);
}

function supportContent() {
	appManager.uiManager.showConfigureContent();
	appManager.state.activeMenu = appManager.uiManager.menuMap["support"].tree;
	var html = "";

	html += appManager.uiManager.getHtmlBlueHeaderBlock("Vyatta Support");
	html += '<p>';

	html += "<a href=\"http://www.vyatta.com/\" target=\"_new\">Vyatta</a></p>";
	html += "<a href=\"http://www.vyatta.com/twiki/bin/view/Community/WebHome\" target=\"_new\">OFR Community Wiki</a></p>";
	document.getElementById('configArea').innerHTML = html;
}

function creditsContent() {
	appManager.uiManager.showConfigureContent();
	var html = "";

	html += appManager.uiManager.getHtmlBlueHeaderBlock("Credits");
	html += '<p>';
	html += '<b>Vyatta OFR</b>';
	html += '<p>';
	html += '<iframe src="/version.cgi" width="90%"></iframe>';
	html += '<p>';
	html += '<b>Copyright &#169; 2006, 2007 <a href="http://www.vyatta.com/" target="_blank">Vyatta Inc.</a></b>';
	html += '<p>';
	html += '<b>Product based on <a href="http://www.xorp.org/" target="_blank">XORP</a> Copyright &#169; 2001-2007 <a href="http://www.icsi.berkeley.edu/" target="_blank">ICSI</a></b>';
	html += '<p>';
	html += '<b>Product licensed by Vyatta</a> under <a href="http://www.gnu.org" target="_blank">GPL2</a>.</b>';
	html += '<p>';
	html += '<b>Initial GUI Graphical Design and Implementation by <a href="http://www.dhapdigital.com" target="_blank">DHAP Digital</a>.</b>';

	if (appManager.state.sessionId == null) {
		html += '<p><br><p>';
		html += '<a href="javascript:loginContent();">Back to login screen</a>';
	}

	document.getElementById('configArea').innerHTML = html;
}

function loginContent() {
	appManager.uiManager.showConfigureContent();
	var html = "";

	html += appManager.uiManager.getHtmlBlueHeaderBlock("Login");
	html += '<p><strong>Please enter your username and password.</strong></p>';
	html += '<form name="login" id="loginForm">';
	html += 'User Name:<br>';
	html += '<input name="user" type="text" id="user" style="width:176px;"><br>';
	html += 'Password:<br>';
	html += '<input name="pwd" type="password" style="width:176px;" onkeypress="formSubmit(event,this);"><br>';
	html += '<br>';
	html += '<a href="javascript:appManager.uiManager.clickLogin()"><img src="images/bt_login.gif" alt="Login" width="46" height="20"></a>';
	html += '</form>';

	document.getElementById('configArea').innerHTML = html;
	document.getElementById('user').focus();
}

function formSubmit(event,formField) {
	if (event.keyCode == 13) {
		appManager.uiManager.clickLogin();
	}
}

var statusBar1 = new Image();
statusBar1.src = 'images/status_bar_1.gif';
var statusBar2 = new Image();
statusBar2.src = 'images/status_bar_2.gif';
var statusBar3 = new Image();
statusBar3.src = 'images/status_bar_3.gif';
var statusBar4 = new Image();
statusBar4.src = 'images/status_bar_4.gif';
var statusBar5 = new Image();
statusBar5.src = 'images/status_bar_5.gif';
var statusBar6 = new Image();
statusBar6.src = 'images/status_bar_6.gif';

</script>
</head>
<body onload="init();">
    <div id="whole_layout">
                <!-- begin left side div container -->
                <div id="left_side_container">
                    <img src="images/logo_no_bt.gif" alt="Vyatta" width="235" height="78" usemap="#collapseNav" border="0" id="logo" name="logo"> <!-- nav -->
                    <div id="contextArea"></div>
                    <div id="operationMenuArea"></div>
                    <div id="toolMenuArea"></div>
                    <div id="supportArea"></div>
                    <p>&nbsp;</p>
                    <div class="copyright">
                        &#169; 2006, 2007 Vyatta Inc.<br><a href="javascript:creditsContent();">Credits</a>
                    </div><!-- end nav -->
                </div><!-- end left side div container -->
                <!-- end right side div container -->
                <div id="right_side_container">
                    <div id="top_nav_div">
                        <div id="top_nav_container">
                            <img src="images/topnav_1.gif" alt="" width="129" height="60" style="float:left;">
                            <div id="top_nav_buttons_div">
                                <a href="javascript:appManager.uiManager.clickCommit();"><img id="commitButton" src="images/bt_commit_inactive.gif" alt="Commit Changes" width="132" height="20" class="top_nav_bt" name="commitButton"></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:appManager.uiManager.clickRevert();"><img id="revertButton" src="images/bt_revert_inactive.gif" alt="Revert" width="57" height="20" class="top_nav_bt" name="revertButton"></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:appManager.uiManager.clickLoad();"><img id="loadButton" src="images/bt_load_inactive.gif" alt="Load..." width="57" height="20" class="top_nav_bt" name="loadButton"></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:appManager.uiManager.clickSave();"><img id="saveButton" src="images/bt_save_inactive.gif" alt="Save..." width="57" height="20" class="top_nav_bt" name="saveButton"></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:appManager.uiManager.clickLogout();"><img id="logoutButton" src="images/bt_logout_inactive.gif" alt="Logout" width="57" height="20" class="top_nav_bt" name="logoutButton"></a>
                            </div>
                        </div>
                        <!--<div id="content_cap_div">
                            <img src="images/content_cap_l.gif" style="float:left;">
			    <img src="images/content_cap_r.gif" style="float:right;">
                        </div>-->
                    </div>
                    <div id="content_container">
                            <!-- begin left content (nav) -->
                            <div id="left_content">
			        <div id="toWarningArea"></div>
			        <div id="messageArea"></div>
			        <div id="configArea"></div>
			        <div id="operationResultArea"></div>
                            </div>
                            <!-- end left content (nav) -->

                            <!-- begin right content -->
                            <div id="right_content">
                                <div id="status_div">
                                    <img src="images/tab_status.gif" alt="Status" width="237" height="19" usemap="#showHidePallettes">
                                    <div id="statusArea" class="right_context_box" style="padding:15px;"></div>
                                </div>
                                <div id="status_collapsed" align="right">
                                    <img src="images/tab_collapsed.gif" alt="Expand Status" id="tab_collapsed_status" width="33" height="66" usemap="#statusMapCollapsed" name="tab_collapsed_status">
                                </div><br>
                                <div id="tools_div">
                                    <img src="images/tab_tools.gif" alt="Tools" width="237" height="19"> <!-- begin tools content -->
                                    <div class="right_context_box">
                                        <div class="tools_detail">
                                            <div style="margin-bottom:7px; margin-top:6px;">
                                                <a href="http://www.vyatta.com/documentation/" target="_blank">Documentation</a>
                                            </div>
                                            <div style="margin-bottom:7px; margin-top:6px;">
                                                <a href="javascript:appManager.launchSubnetCalc()">Subnet Calculator</a>
                                            </div>
                                            <div style="margin-bottom:7px; margin-top:6px;">
                                                <a href="javascript:appManager.launchExecs()">Started Operations</a>
                                            </div>
                                            <div style="margin-bottom:7px; margin-top:6px;">
                                                <a href="javascript:appManager.launchConfig()">Show Configuration</a>
                                            </div>
                                        </div>
                                        <div id="toolsArea"></div><br>
                                    </div><!-- end tools content -->
                                </div>
                                <div id="tools_collapsed" align="right">
                                    <img src="images/tab_collapsed.gif" alt="Expand Tools" id="tab_collapsed_tools" width="33" height="66" usemap="#toolsMapCollapsed" name="tab_collapsed_tools">
                                </div>
                            </div><!-- end right content -->
                    </div>
                </div><!-- end right side div container -->
    </div><!-- end main div container -->
    <div id="operationsArea" style="display:none"></div>
    <div id="operationArgsArea" style="display:none"></div>
    <div id="operationResultsArea" style="display:none"></div>
    <p style="display:none">Request Debug:</p>
    <div id="requestDebug" style="display:none"></div>
    <p style="display:none">Response Debug:</p>
    <div id="responseDebug" style="display:none"></div>
    <map name="showHidePallettes" id="showHidePallettes">
        <area shape="rect" coords="200,1,237,12" href="javascript:;" alt="Hide Palettes" onclick="appManager.uiManager.collapsePalettes();">
    </map> <map name="statusMapCollapsed" id="statusMapCollapsed">
        <area shape="rect" coords="18,5,29,16" href="javascript:;" alt="Expand Status Area" onclick="appManager.uiManager.expandPalettes();">
    </map> <map name="toolsMapCollapsed" id="toolsMapCollapsed">
        <area shape="rect" coords="18,5,29,16" href="javascript:;" alt="Expand Tools Area" onclick="appManager.uiManager.expandPalettes();">
    </map> <map name="collapseNav" id="collapseNav">
        <area shape="rect" coords="218,64,228,74" href="javascript:appManager.uiManager.clickConstrictMenus();" alt="Collapse Unused Items" onclick="">
    </map>
</body>
</html>

